<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<title>Noise to work</title>
	<style>
		.trackControlls div {
			width: 100px; 
			height: 100px; 
			display: inline-block;
		}

		.oneTrackControllDisabled {
			background-color: blue; 			
		}

		.oneTrackControllEnabled {
			background-color: red; 			
		}
	</style>
</head>
<body>

	<div class="trackControlls">
		<div id="controllTrain" class="oneTrackControllDisabled">Play Train</div>
		<div id="controllWater" class="oneTrackControllDisabled">Play Water</div>
	</div>

	<script>
		const maxTimeToResetAudioPlayingTime = .44;

		function prepareAudioWithoutGaps(pathToFile) {
			var audioFile = new Audio(pathToFile);
			audioFile.addEventListener('timeupdate', function () {
				var buffer = maxTimeToResetAudioPlayingTime;
				if(this.currentTime > this.duration - buffer){
					this.currentTime = 0;
					this.play();
				}
			}, false);
			audioFile.load();
			return audioFile;
		}

		class Track {
			constructor(pathToFile, idOfHtmlControll) {
				this.audioFile = prepareAudioWithoutGaps(pathToFile);
				this.idOfHtmlControll = idOfHtmlControll;

				bindUserControlls(this);
			}
		}

		function bindUserControlls(track) {
			document.getElementById(track.idOfHtmlControll).addEventListener("click", function (event) {
				playSound(track.audioFile, event.target);
			});
		}

		function playSound(audioFile, controllHtmlNode) {
			audioFile.play();
			controllHtmlNode.className = "oneTrackControllEnabled";
		}

		const pathToTrain = "sounds/train.mp3";
		const pathToWater = "sounds/water.mp3";

		new Track(pathToTrain, "controllTrain");
		new Track(pathToWater, "controllWater");	
	</script>
</body>
</html>